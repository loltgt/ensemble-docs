!function(t,e){if("function"==typeof define&&define.amd)define(["exports"],e);else if("undefined"!=typeof exports)e(exports);else{var n={exports:{}};e(n.exports),t.ensemble=n.exports}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,(function(t){"use strict";
/*!
   * loltgt ensemble.Compo
   *
   * @version 0.0.1
   * @copyright Copyright (C) Leonardo Laureti
   * @license MIT License
   */function e(t,n,i){return(e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,n,i||t)}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function r(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=s(t);if(e){var r=s(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==p(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e,n,i,r,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(i,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.Modal=t.Lightbox=void 0;var c=function(t){var e,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function l(t,e,n,i){var r=e&&e.prototype instanceof y?e:y,o=Object.create(r.prototype),s=new C(i||[]);return o._invoke=function(t,e,n){var i=h;return function(r,o){if(i===p)throw new Error("Generator is already running");if(i===d){if("throw"===r)throw o;return N()}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=E(s,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var c=u(t,e,n);if("normal"===c.type){if(i=n.done?d:f,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=d,n.method="throw",n.arg=c.arg)}}}(t,n,s),o}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var h="suspendedStart",f="suspendedYield",p="executing",d="completed",v={};function y(){}function m(){}function g(){}var b={};b[o]=function(){return this};var w=Object.getPrototypeOf,k=w&&w(w(O([])));k&&k!==n&&i.call(k,o)&&(b=k);var _=g.prototype=y.prototype=Object.create(b);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(r,o,s,a){var c=u(t[r],t,o);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,a)}))}a(c.arg)}var r;this._invoke=function(t,i){function o(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(o,o):o()}}function E(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var r=u(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,v;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function O(t){if(t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,s=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}return{next:N}}function N(){return{value:e,done:!0}}return m.prototype=_.constructor=g,g.constructor=m,m.displayName=c(g,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,a,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},x(L.prototype),L.prototype[s]=function(){return this},t.AsyncIterator=L,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var s=new L(l(e,n,i,r),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},x(_),c(_,a,"Generator"),_[o]=function(){return this},_.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=O,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return a.type="throw",a.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;S(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:O(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=c}catch(t){Function("r","regeneratorRuntime = r")(c)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function s(t){a(o,i,r,s,c,"next",t)}function c(t){a(o,i,r,s,c,"throw",t)}s(void 0)}))}}function u(){return(u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function h(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function y(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),t}var m="undefined"==typeof Symbol?0:Symbol,g=/html|head|body|meta|link|style|script/i,b=/(<(html|head|body|meta|link|style|script)*>)/i,w=/attributes|classList|innerHTML|outerHTML|nodeName|nodeType/,k=function(){function t(e,n,i,r){if(d(this,t),!(this instanceof t?this.constructor:void 0))throw"ensemble error: Bad invocation, must be called with new.";var o=this._ns="_"+e,s=i?n.toString():"div";if(g.test(s))throw new Error("ensemble.Compo error: The tag name provided ('".concat(s,"') is not a valid name."));var a=this[o]=document.createElement(s);if(this.__Compo=!0,this[o].__compo=this,r&&"object"==p(r))for(var c in r){var l=c.toString();if(w.test(l))throw new Error("ensemble.Compo error: The property name provided ('".concat(l,"')' is not a valid name."));if(0===l.indexOf("on")&&r[l])a[l]=r[l].bind(this);else if("object"!=p(r[l]))a[l]=r[l];else if("children"===l&&"object"==p(r[l])&&r[l].length){var u,f=h(r.children);try{for(f.s();!(u=f.n()).done;){var v=u.value,y=v.tag,m=v.name,b=v.props;this.append(new t(e,y,m,b))}}catch(t){f.e(t)}finally{f.f()}}}if(0!=i&&1!=i){var k=a.className;a.className=e+"-"+n,i&&(a.className+=" "+e+"-"+i),k&&(a.className+=" "+k)}}return y(t,[{key:"install",value:function(t,e){return"function"==typeof e&&e.call(this,this[this._ns]),!!t.appendChild(this[this._ns])}},{key:"uninstall",value:function(t,e){return"function"==typeof e&&e.call(this,this[this._ns]),!!t.removeChild(this[this._ns])}},{key:"up",value:function(t,e){return"function"==typeof e&&e.call(this,this[this._ns]),!!t.replaceWith(this[this._ns])}},{key:"append",value:function(t){var e=this._ns;return!!this[e].appendChild(t[e])}},{key:"prepend",value:function(t){var e=this._ns;return!!this[e].prependChild(t[e])}},{key:"remove",value:function(t){var e=this._ns;return!!this[e].removeChild(t[e])}},{key:"replace",value:function(t){}},{key:"clone",value:function(){}},{key:"inject",value:function(t){if(t instanceof Element==0||g.test(t.tagName)||b.test(t.innerHTML))throw new Error("ensemble.Compo error: The remote object could not be resolved into a valid node.");return this.empty(),!!this[this._ns].appendChild(t)}},{key:"empty",value:function(){for(;this.first;)this.remove(this.first)}},{key:"hasAttr",value:function(t){return this[this._ns].hasAttribute(t)}},{key:"getAttr",value:function(t){return this[this._ns].getAttribute(t)}},{key:"setAttr",value:function(t,e){this[this._ns].setAttribute(t,e)}},{key:"delAttr",value:function(t){this[this._ns].removeAttribute(t)}},{key:"getStyle",value:function(t){return window.getComputedStyle(this[this._ns])[t]}},{key:"show",value:function(){this[this._ns].hidden=!1}},{key:"hide",value:function(){this[this._ns].hidden=!0}},{key:"enable",value:function(){this[this._ns].disabled=!1}},{key:"disable",value:function(){this[this._ns].disabled=!0}},{key:"node",get:function(){return console.warn("ensemble.Compo","Direct access to the Element node is strongly discouraged."),this[this._ns]}},{key:"parent",get:function(){var t=this._ns;return this[t].parentElement&&"__compo"in this[t].parentElement?this[t].parentElement.__compo:null}},{key:"children",get:function(){return Array.prototype.map.call(this[this._ns].children,(function(t){return t.__compo}))}},{key:"first",get:function(){var t=this._ns;return this[t].firstElementChild?this[t].firstElementChild.__compo:null}},{key:"last",get:function(){var t=this._ns;return this[t].lastElementChild?this[t].lastElementChild.__compo:null}},{key:"previous",get:function(){var t=this._ns;return this[t].previousElementSibling?this[t].previousElementSibling.__compo:null}},{key:"next",get:function(){var t=this._ns;return this[t].nextElementSibling?this[t].nextElementSibling.__compo:null}},{key:"classList",get:function(){return this[this._ns].classList}},{key:m.toStringTag,get:function(){return"ensemble.Compo"}}],[{key:"isCompo",value:function(e){return m?m.for(e)===m.for(t.prototype):e&&"object"==p(e)&&"__Compo"in e}}]),t}(),_="undefined"==typeof Symbol?0:Symbol,x=function(){function t(e,n){if(d(this,t),!(this instanceof t?this.constructor:void 0))throw"ensemble error: Bad invocation, must be called with new.";n&&"object"==p(n)&&u(this,{},n);var i=this._ns="_"+e;this.__Data=!0,this[i]={ns:e}}var e,n,i;return y(t,[{key:"compo",value:function(t,e,n){var i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=this[this._ns].ns;return i=r?{ns:a,tag:t,name:e,props:n,fresh:o,stale:s}:new k(a,t,e,n),o&&"function"==typeof o&&(i.fresh=n.onfresh=o),s&&"function"==typeof s&&(i.stale=n.onstale=s),i}},{key:"render",value:(i=l(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this[n=this._ns][e]&&this[n][e].rendered||(this[n][e]={rendered:!0,fresh:this[e].fresh,stale:this[e].stale,params:this[e]},this[e]=new k(this[e].ns,this[e].tag,this[e].name,this[e].props)),this[n][e].fresh();case 2:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"stale",value:(n=l(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this[n=this._ns][e]&&this[n][e].rendered&&this[n][e].stale();case 2:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"reflow",value:(e=l(regeneratorRuntime.mark((function t(e,n){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=this._ns,n?this[i][e]=this.compo(this[i][e].params.ns,this[i][e].params.name,this[i][e].params.props):this[i][e]&&this[i][e].rendered&&this[i][e].fresh();case 2:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:_.toStringTag,get:function(){return"ensemble.Data"}}],[{key:"isData",value:function(e){return _?_.for(e)===_.for(t.prototype):e&&"object"==p(e)&&"__Data"in e}}]),t}(),L="undefined"==typeof Symbol?0:Symbol,E=function(){function t(e,n,i){if(d(this,t),!(this instanceof t?this.constructor:void 0))throw"ensemble error: Bad invocation, must be called with new.";var r=this._ns="_"+e;i=(k.isCompo(i)?i.node:i)||document,this.__Event=!0,this[r]={name:n,node:i}}return y(t,[{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this[this._ns].node.addEventListener(this[this._ns].name,t,e)}},{key:"remove",value:function(t){this[this._ns].node.removeEventListener(this[this._ns].name,t)}},{key:L.toStringTag,get:function(){return"ensemble.Event"}}],[{key:"isEvent",value:function(e){return L?L.for(e)===L.for(t.prototype):e&&"object"==p(e)&&"__Event"in e}}]),t}(),j=function(t){n(i,t);var e=r(i);function i(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d(this,i),(n=e.call(this))._bindings(),n.options=n.defaults(n._defaults(),r),Object.freeze(n.options),n.element=t,n}return y(i,[{key:"_defaults",value:function(){return{ns:"modal",root:"body",fx:!0,windowed:!1,cloning:!0,backClose:!0,keyboard:!0,close:{onclick:this.close,innerText:"×",ariaLabel:"Close"},onOpen:function(){},onClose:function(){},onShow:function(){},onHide:function(){},onContent:function(){}}}},{key:"_bindings",value:function(){this.open=this.binds(this.open),this.close=this.binds(this.close),this.backx=this.binds(this.backx),this.keyboard=this.binds(this.keyboard)}},{key:"generator",value:function(){var t=this.options,e=this.box=this.data({onclick:!1}),n=this.box.wrap=this.compo("dialog",!0,{className:t.ns,hidden:!0,ariaModal:!0,role:"dialog",onclick:function(){e.onclick&&"function"==typeof e.onclick&&e.onclick.apply(this,arguments)}}),i=this.cnt=this.compo("content"),r=this.compo("button","close",t.close);n.append(i),t.windowed?(n.classList.add(t.ns+"-windowed"),i.append(r)):n.append(r),t.backClose&&(this.box.onclick=this.backx),t.fx&&n.classList.add(t.ns+"-fx"),this.root=this.selector(t.root),this.built=!0}},{key:"populate",value:function(t){console.log("ensemble.Modal","populate()",t);var e=this.content(this.element);this.cnt.append(e)}},{key:"resume",value:function(t){console.log("ensemble.Modal","resume()",t)}},{key:"content",value:function(t,e){var n=this.options,i=this.compo("object"),r=(e=void 0!==e?e:n.cloning)?this.cloneNode(t,!0):t;return n.onContent.call(this,this,i,r),r&&i.inject(r),i}},{key:"destroy",value:function(){var t=this.root,e=this.box.wrap;this.removeNode(t,e),this.built=!1}},{key:"open",value:function(t,e){if(this.event(t),!this.opened){var n=this.options;this.built?this.resume(e):(this.generator(),this.populate(e)),this.opened=!0,n.onOpen.call(this,this,e,t),this.show(e),n.keyboard&&this.event("keydown").add(this.keyboard),console.log("ensemble.Modal","open()",this)}}},{key:"close",value:function(t,e){if(this.event(t),this.opened){var n=this.options;this.opened=!1,n.onClose.call(this,this,e,t),this.hide(e),n.keyboard&&this.event("keydown").remove(this.keyboard),console.log("ensemble.Modal","close()",this)}}},{key:"show",value:function(t){var e=this.options,n=this.root;this.box;var i=this.box.wrap;i.install(n),this.delay((function(){i.show(),e.onShow.call(self,self,t)}))}},{key:"hide",value:function(t){var e=this.options,n=this.root;this.box;var i=this.box.wrap;i.hide(),this.delay((function(){i.uninstall(n),e.onHide.call(self,self,t)}),i,300)}},{key:"backx",value:function(t){this.event(t);var e,n=t.target,i=n.parentElement,r=this.options.ns;if(((e=new RegExp(r+"-content")).test(n.className)||e.test(i.className))&&(console.log("ensemble.Modal","backx()","outside cropbox area",":then: close",i,n),this.close(t)),(e=new RegExp(r+"-object")).test(n.className)){var o=n.firstElementChild,s=o.offsetWidth,a=o.offsetHeight,c=n.offsetTop,l=n.offsetLeft,u=n.offsetWidth,h=n.offsetHeight,f=event.x,p=event.y,d=(h-a)/2,v=(u-s)/2,y=d+a,m=v+s;console.log("ensemble.Modal","backx()","coords",{x:f,y:p},{target_t:c,target_l:l,target_w:u,target_h:h},{crop_t:d,crop_r:m,crop_b:y,crop_l:v}),(p>c||f>l||f<u||p<h)&&(p<d||f>m||p>y||f<v)&&(console.log("ensemble.Modal","backx()","outside cropbox area",":then: close",i,n),this.close(t))}else console.log("ensemble.Modal","backx()","outside cropbox area",":then: skip",i,n)}},{key:"keyboard",value:function(t){this.event(t),27===(t.keyCode||0)&&this.close(t)}}]),i}(function(){function t(){if(d(this,t),!(this instanceof t?this.constructor:void 0))throw"ensemble error: Bad invocation, must be called with new."}return y(t,[{key:"defaults",value:function(t,e){var n={};for(var i in t)null!=t[i]&&"object"===p(t[i])?n[i]=u(t[i],e[i]):n[i]=void 0!==e[i]?e[i]:t[i];return n}},{key:"compo",value:function(t,e,n){return t?new k(this.options.ns,t,e,n):k}},{key:"data",value:function(t){return t?new x(this.options.ns,t):x}},{key:"event",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return"string"==typeof t?new E(this.options.ns,t,e):t?(t.preventDefault(),void t.target.blur()):E}))},{key:"selector",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e=e||document,n?e.querySelectorAll(t):e.querySelector(t)}},{key:"appendNode",value:function(t,e){return!!t.appendChild(e)}},{key:"prependNode",value:function(t,e){return!!t.prependChild(e)}},{key:"removeNode",value:function(t,e){return!!t.removeChild(e)}},{key:"cloneNode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.cloneNode(e)}},{key:"hasAttr",value:function(t,e){return t.hasAttribute(e)}},{key:"getAttr",value:function(t,e){return t.getAttribute(e)}},{key:"setAttr",value:function(t,e,n){t.setAttribute(e,n)}},{key:"delAttr",value:function(t,e){t.removeAttribute(e)}},{key:"binds",value:function(t){var e=this;return function(n){t.call(e,n,this)}}},{key:"delay",value:function(t,e,n){var i=e?this.timing(e):0;setTimeout(t,i||n)}},{key:"timing",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"transitionDuration",n=k.isCompo(t)?t.getStyle(e):window.getComputedStyle(t)[e];return n&&(n=n.indexOf("s")?1e3*parseFloat(n):parseInt(n)),n||0}}]),t}());
/*!
   * loltgt ensemble.Lightbox
   *
   * @version 0.0.1
   * @copyright Copyright (C) Leonardo Laureti
   * @license MIT License
   */
t.Modal=j;var S=function(t){n(o,t);var i=r(o);function o(){return d(this,o),i.apply(this,arguments)}return y(o,[{key:"_defaults",value:function(){return u(e(s(o.prototype),"_defaults",this).call(this),{selector:"",contents:null,navigation:!0,captioned:!0,infinite:!0,autoDiscover:!0,autoHide:"navigation",overlayed:!1,checkOrigin:!0,prev:{onclick:this.prev,innerText:"<",ariaLabel:"Previous"},next:{onclick:this.next,innerText:">",ariaLabel:"Next"},onStep:function(){},onSlide:function(){},onCaption:function(){}})}},{key:"_bindings",value:function(){e(s(o.prototype),"_bindings",this).call(this),this.add=this.binds(this.add),this.remove=this.binds(this.remove),this.prev=this.binds(this.prev),this.next=this.binds(this.next)}},{key:"generator",value:function(){e(s(o.prototype),"generator",this).call(this);var t=this.box.wrap,n=this.cnt,i=this.options,r=this.gallery=this.compo("gallery");if(n.append(r),t.classList.add(i.ns+"-lightbox"),i.navigation){var a=this.nav=this.data(!0),c=a.wrap=this.compo("nav"),l=a.prev=this.compo("button","prev",i.prev),u=a.next=this.compo("button","next",i.next);c.append(l),c.append(u)}if(i.captioned){var h=this.captions=this.data(!0);h.wrap=this.compo("captions")}if(i.overlayed){var f=i.overlayed.toString().match(/captions|navigation/);t.classList.add(i.ns+"-overlayed"),f&&t.classList.add(i.ns+"-overlayed-"+overlayed[0])}if(i.autoHide){var p=i.autoHide.toString().match(/captions|navigation/);t.classList.add(i.ns+"-autohide"),p&&t.classList.add(i.ns+"-autohide-"+p[0])}i.windowed?(i.navigation&&n.append(a.wrap),i.captioned&&n.append(h.wrap)):(i.navigation&&t.append(a.wrap),i.captioned&&t.append(h.wrap))}},{key:"populate",value:function(t){console.log("ensemble.Lightbox","populate",t);var e,n=this.options;n.contents&&"object"==p(n.contents)?e=n.contents:n.selector&&(e=this.selector(n.selector,this.element,!0));var i,r=h(e=this.contents=this.prepare(e));try{for(r.s();!(i=r.n()).done;){var o=i.value,s=this.content(o);t&&t===s.ref&&(this.index=e.indexOf(s),this.current=s),this.add(s)}}catch(t){r.e(t)}finally{r.f()}this.current=this.current||e[0],this.index=this.index||0,this.slide(0),n.navigation&&this.navigation(),n.captioned&&this.caption()}},{key:"resume",value:function(t){console.log("ensemble.Lightbox","resume",t);var e,n=this.options,i=this.contents,r=h(i);try{for(r.s();!(e=r.n()).done;){var o=e.value;o.wrap.hide(),t&&t===o.ref&&(this.index=i.indexOf(o),this.current=o)}}catch(t){r.e(t)}finally{r.f()}this.current=this.current||i[0],this.index=this.index||0,this.slide(0),n.navigation&&this.navigation(),n.captioned&&this.caption()}},{key:"content",value:function(t,e){var n,i=this.options,r=this.compo("object");r.hide();var o=(n="string"==typeof t?this.data({src:t}):t).src,s=n.type,a=n.type;a&&(a=(a=a.match(/(^image|video|audio)|(pdf$)/))?a[0]:"");var c,l=/^https?:\/\//.test(o),u=!1;(i.autoDiscover&&o&&!a&&(/\.jpg|\.jpeg|\.png|\.apng|\.gif|\.webp|\.avif|\.bmp|\.svg$/i.test(o)?a="image":/\.pdf$/.test(o)?a="pdf":/\.mp4|\.webm|\.ogv|\.m4v|\.hevc|\.ivf|\.obu|\.ismv|\.mkv$/i.test(o)?a="video":/\.mp3|\.opus|\.ogg|\.m4a|\.aac|\.flac|\.wav|\.weba|\.mka$/i.test(o)?a="audio":/^data:image\/jpeg|png|apng|gif|webp|avif|bmp|svg\+xml/.test(o)&&(u=!0,a="image")),"pdf"==a&&(a="iframe",c="pdf"),i.checkOrigin&&o&&l&&!u)&&(("null"!=window.origin?window.origin:window.location.origin)!=new URL(o).origin&&(a=""));if(o&&!a)if("#"==o[0]){var h=this.selector(o);h&&(n.node=h,a=/iframe|img|picture|video|audio/i.test(h.nodeName)?/img|picture/i.test(h.nodeName)?"image":h.nodeName.toLowerCase():"element")}else a="iframe";"element"===a&&(e=void 0!==e?e:i.cloning,n.node=e?this.cloneNode(n.node,!0):n.node),c||s==a||(c=s),n.ref=n.ref||null,n.type=a,n.src=o,i.onContent.call(this,this,n),a&&r.classList.add(i.ns+"-"+a),c&&r.classList.add(i.ns+"-"+c);var f=this.inner(n);return n.fresh=function(){n.node&&n.inner.inject(n.node),n.wrap.show()},n.stale=function(){n.node&&n.inner.empty(),n.wrap.hide()},n.wrap=r,n.inner=n.compo(f.tag,f.name,f.props,!0,n.fresh,n.stale),n}},{key:"inner",value:function(t){var e=t.type,n=!0,i={};for(var r in t)/ref|src|type|sources|subtitles|children/.test(r)||"_"==r[0]||(i[r]=t[r]);switch(t.src&&(i.src=t.src),t.type){case"image":if(e="img",t.sources||t.children)if(e="picture",i.children=[],t.sources&&"object"==p(t.source)){var o,s=h(t.sources);try{for(s.s();!(o=s.n()).done;){var a=o.value;i.children.push({tag:"source",name:!0,props:a})}}catch(t){s.e(t)}finally{s.f()}}else if(t.children&&t.children.length){var c,l=h(t.children);try{for(l.s();!(c=l.n()).done;){var u=c.value,f=u.tagName.toLowerCase();"source"==f&&"img"==f&&i.children.push({tag:f,name:!0,props:u.attributes})}}catch(t){l.e(t)}finally{l.f()}}break;case"video":case"audio":if(i.controls=!t.controls||t.controls,i.children=[],t.sources&&"object"==p(t.sources)){var d,v=h(t.sources);try{for(v.s();!(d=v.n()).done;){var y=d.value;i.children.push({tag:"source",name:!0,props:y})}}catch(t){v.e(t)}finally{v.f()}if(t.subtitles&&"object"==p(t.subtitles)){var m,g=h(t.subtitles);try{for(g.s();!(m=g.n()).done;){var b=m.value;i.children.push({tag:"track",name:!0,props:b})}}catch(t){g.e(t)}finally{g.f()}}}else if(t.children&&t.children.length){var w,k=h(t.children);try{for(k.s();!(w=k.n()).done;){var _=w.value,x=_.tagName.toLowerCase();"source"==x&&"track"==x&&i.children.push({tag:x,name:!0,props:_.attributes})}}catch(t){k.e(t)}finally{k.f()}}break;case"iframe":if(i.frameBorder=0,!i.src)return null;break;default:e="div",n="custom-element"}return{tag:e,name:n,props:i}}},{key:"prepare",value:function(t){var e=[];if(t&&"object"==p(t)&&t.length){var n,i=h(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if("object"==p(r)&&"nodeName"in r){var o=this.data(!0),s=r.dataset;if(u(o,s),o.ref=r,s.sources)try{o.sources=JSON.parse(s.sources)}catch(t){}if(r.href)o.src=r.href;else if(s.href)o.src=s.href;else if(/iframe|img|picture|video|audio/i.test(r.nodeName)){var a=r.nodeName.toLowerCase();/img|picture/.test(a)?o.type="image":o.type=a,"iframe"!=a&&r.children&&r.children.length&&(o.children=r.children)}else o.type="element",o.node=r;s.caption&&(o.caption=s.caption),e.push(o)}else"string"==typeof r?e.push(r):"type"in r&&/(^element|iframe|image|video|audio|pdf)/.test(r.type)?e.push(this.data(r)):e.push(this.data(!0))}}catch(t){i.e(t)}finally{i.f()}}return e}},{key:"add",value:function(t){this.gallery.append(t.wrap),this.options.navigation&&this.navigation()}},{key:"remove",value:function(t){this.gallery.remove(t.wrap),this.options.navigation&&this.navigation()}},{key:"prev",value:function(t){this.event(t),this.slide(-1)}},{key:"next",value:function(t){this.event(t),this.slide(1)}},{key:"slide",value:function(t){var e=this.options;if(e.infinite||0==this.way||this.way!==t){var n=this.contents,i=this.index,r=this.current,o=r;if(e.onStep.call(this,this,r,t),0!=t){var s=n.length-1,a=-1===t?n[i-1]:n[i+1],c=-1===t?n[s]:n[0];o=a||c,i=a?-1===t?i-1:i+1:-1===t?s:0,r.stale("inner")}if(!e.infinite){var l=0;o.wrap.previous?o.wrap.next||(l=1):l=-1,this.way=parseInt(l),e.navigation&&this.navigation(l)}o.render("inner"),o.wrap.append(o.inner),e.onSlide.call(this,this,r,t,r.wrap!=o.wrap?o.wrap:null),this.delay((function(){0!=t&&r.wrap.remove(r.inner)}),r.wrap),this.index=i,this.current=n[i],e.captioned&&this.caption()}}},{key:"navigation",value:function(t){var e=this.nav;if(this.contents.length>1){if(e.wrap.show(),!this.options.infinite&&void 0!==t)switch(t){case-1:e.prev.disable(),e.next.enable();break;case 1:e.prev.enable(),e.next.disable();break;default:e.prev.enable(),e.next.enable()}}else e.wrap.hide()}},{key:"caption",value:function(t){var e=this.options,n=this.captions,i=this.current;if(n.wrap.empty(),!e.onCaption(this,this,i,t)){if(!t)if(i.caption)t=i.caption;else if(e.selector){var r=i.ref;if(this.hasAttr(r,"title"))t=this.getAttr(r,"title");else if("image"===i.type){t=this.selector("img",r).alt}}if(t){var o,s=h(t=t.split(/\n\n|\r\n\r\n/));try{for(s.s();!(o=s.n()).done;){var a=o.value,c=this.compo("p",!0,{innerText:a});n.wrap.append(c)}}catch(t){s.e(t)}finally{s.f()}}}}},{key:"keyboard",value:function(t){switch(e(s(o.prototype),"keyboard",this).call(this,t),t.keyCode||0){case 37:this.prev(t);break;case 39:this.next(t)}}}]),o}(j);t.Lightbox=S}));